---
title: "Figure A.5. - Validity and Reliability"
---

Data
```{r}
source("source_file.R")
df = read.csv(paste0(data_dir, "reliability_validity_data.csv"))
```

Calculate reliability, using Krippendorff's Alpha
```{r}
kripp_matrix = as.matrix(rbind(as.vector(df$english), as.vector(df$italian), as.vector(df$german),
                               as.vector(df$spanish), as.vector(df$dutch), as.vector(df$french),
                               as.vector(df$danish)), nrow = 7)
irr::kripp.alpha(kripp_matrix,"nominal")
```
Evaluate validity using Generalized ANOVA
```{r}
stack = stack(merge, select = -c(type, unique))
anova = glm(values~ind, family="binomial", data = stack)
summary(anova)
```

```{r}
agg = data.frame(English = mean(merge$ENG_FP), 
                 Italian = mean(merge$IT_FP),
                 German = mean(merge$GE_FP),
                 Spanish = mean(merge$ES_FP),
                 Dutch = mean(merge$NL_FP),
                 French = mean(merge$FR_FP), 
                 Danish = mean(merge$DK_FP.x))
agg = stack(agg)
colnames(agg) = c("prop", "lang")
```

```{r}
library(ggplot2)
ggplot(data=agg, aes(x=as.factor(lang), y=prop)) + geom_hline(yintercept = mean(agg$prop), color = "grey80", size = 2) +
 geom_bar(stat="identity", alpha = 0.7, color = "black") + theme_minimal() + 
 ylab("Proportion Coded as False Positive") + xlab(" ")
```


